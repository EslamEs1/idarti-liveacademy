<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إضافة/تعديل جلسة - IDARTI Live Academy</title>
    
    <!-- Bootstrap RTL CSS -->
    <link rel="stylesheet" href="../../assets/css/bootstrap.rtl.min.css">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Custom System CSS -->
    <link rel="stylesheet" href="../../assets/css/custom_system.css">
</head>
<body>
    <div class="d-flex">
        <!-- Sidebar -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <div class="content-wrapper">
            <!-- Navbar -->
            <div id="navbar-container"></div>

            <!-- Page Content -->
            <div class="container-fluid px-4 py-4">
                <!-- Breadcrumb -->
                <nav aria-label="breadcrumb" class="mb-4">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/system/dashboard/admin.html">لوحة التحكم</a></li>
                        <li class="breadcrumb-item"><a href="/system/courses/list-admin.html">الدورات</a></li>
                        <li class="breadcrumb-item"><a href="/system/courses/detail-admin.html">الرياضيات المتقدمة</a></li>
                        <li class="breadcrumb-item"><a href="/system/courses/sessions-list-admin.html">الجلسات</a></li>
                        <li class="breadcrumb-item active" id="pageMode">إضافة جلسة</li>
                    </ol>
                </nav>

                <!-- Page Header -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h4 class="mb-1 fw-bold" id="pageTitle">إضافة جلسة جديدة</h4>
                        <p class="text-muted mb-0">املأ تفاصيل الجلسة أدناه</p>
                    </div>
                    <a href="/system/courses/sessions-list-admin.html" class="btn btn-light">
                        <i class="bi bi-arrow-right me-2"></i>رجوع
                    </a>
                </div>

                <!-- Form -->
                <form class="needs-validation" novalidate>
                    <!-- Basic Information Card -->
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0 fw-bold">
                                <i class="bi bi-info-circle me-2"></i>معلومات أساسية
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Session Title -->
                                <div class="col-md-12">
                                    <label for="sessionTitle" class="form-label">عنوان الجلسة <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="sessionTitle" required placeholder="مثال: مقدمة في React Hooks">
                                    <div class="invalid-feedback">
                                        يرجى إدخال عنوان الجلسة
                                    </div>
                                </div>

                                <!-- Session Number -->
                                <div class="col-md-4">
                                    <label for="sessionNumber" class="form-label">رقم الجلسة <span class="text-danger">*</span></label>
                                    <input type="number" class="form-control" id="sessionNumber" required min="1" placeholder="25">
                                    <div class="invalid-feedback">
                                        يرجى إدخال رقم الجلسة
                                    </div>
                                </div>

                                <!-- Module -->
                                <div class="col-md-8">
                                    <label for="sessionModule" class="form-label">الوحدة <span class="text-danger">*</span></label>
                                    <select class="form-select" id="sessionModule" required>
                                        <option value="">اختر الوحدة...</option>
                                        <option>الوحدة الأولى: مقدمة في تطوير الويب</option>
                                        <option>الوحدة الثانية: تطوير الواجهات الأمامية</option>
                                        <option>الوحدة الثالثة: برمجة الباك إند</option>
                                        <option>الوحدة الرابعة: State Management</option>
                                        <option selected>الوحدة الخامسة: الكيمياء العضوية</option>
                                        <option>الوحدة السادسة: Performance & Testing</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        يرجى اختيار الوحدة
                                    </div>
                                </div>

                                <!-- Description -->
                                <div class="col-md-12">
                                    <label for="sessionDescription" class="form-label">وصف الجلسة</label>
                                    <textarea class="form-control" id="sessionDescription" rows="3" placeholder="وصف مختصر لمحتوى الجلسة..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Schedule Card -->
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0 fw-bold">
                                <i class="bi bi-calendar-event me-2"></i>الجدول الزمني
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Date -->
                                <div class="col-md-4">
                                    <label for="sessionDate" class="form-label">تاريخ الجلسة <span class="text-danger">*</span></label>
                                    <input type="date" class="form-control" id="sessionDate" required>
                                    <div class="invalid-feedback">
                                        يرجى اختيار التاريخ
                                    </div>
                                </div>

                                <!-- Start Time -->
                                <div class="col-md-4">
                                    <label for="startTime" class="form-label">وقت البدء <span class="text-danger">*</span></label>
                                    <input type="time" class="form-control" id="startTime" required value="18:00">
                                    <div class="invalid-feedback">
                                        يرجى اختيار وقت البدء
                                    </div>
                                </div>

                                <!-- Duration -->
                                <div class="col-md-4">
                                    <label for="sessionDuration" class="form-label">مدة الجلسة <span class="text-danger">*</span></label>
                                    <select class="form-select" id="sessionDuration" required>
                                        <option value="">اختر المدة...</option>
                                        <option>ساعة واحدة</option>
                                        <option selected>ساعتان</option>
                                        <option>3 ساعات</option>
                                        <option>4 ساعات</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        يرجى اختيار المدة
                                    </div>
                                </div>

                                <!-- End Time (auto-calculated) -->
                                <div class="col-md-12">
                                    <div class="alert alert-info mb-0">
                                        <i class="bi bi-info-circle me-2"></i>
                                        <strong>وقت الانتهاء المتوقع:</strong> 08:00 م
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Instructor & Meeting Card -->
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0 fw-bold">
                                <i class="bi bi-person-badge me-2"></i>المعلم والاجتماع
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Instructor -->
                                <div class="col-md-6">
                                    <label for="instructor" class="form-label">المعلم <span class="text-danger">*</span></label>
                                    <select class="form-select" id="instructor" required>
                                        <option value="">اختر المعلم...</option>
                                        <option selected>د. أحمد محمد</option>
                                        <option>أ. فاطمة علي</option>
                                        <option>د. خالد عبدالله</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        يرجى اختيار المعلم
                                    </div>
                                </div>

                                <!-- Meeting Method -->
                                <div class="col-md-6">
                                    <label for="meetingMethod" class="form-label">طريقة الاجتماع <span class="text-danger">*</span></label>
                                    <select class="form-select" id="meetingMethod" required>
                                        <option value="">اختر الطريقة...</option>
                                        <option selected>Zoom</option>
                                        <option>Google Meet</option>
                                        <option>Microsoft Teams</option>
                                        <option>رابط خارجي</option>
                                    </select>
                                    <div class="invalid-feedback">
                                        يرجى اختيار طريقة الاجتماع
                                    </div>
                                </div>

                                <!-- Meeting Link -->
                                <div class="col-md-12">
                                    <label for="meetingLink" class="form-label">رابط الاجتماع</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-link-45deg"></i></span>
                                        <input type="url" class="form-control" id="meetingLink" placeholder="https://zoom.us/j/123456789">
                                        <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#createZoomModal">
                                            <i class="bi bi-plus-circle me-1"></i>إنشاء رابط Zoom
                                        </button>
                                    </div>
                                    <small class="text-muted">سيتم إنشاء رابط تلقائيًا عند الحفظ إذا تركت هذا الحقل فارغًا</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Attendance & Settings Card -->
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0 fw-bold">
                                <i class="bi bi-gear me-2"></i>إعدادات الحضور والجلسة
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Attendance Type -->
                                <div class="col-md-6">
                                    <label for="attendanceType" class="form-label">طريقة تسجيل الحضور</label>
                                    <select class="form-select" id="attendanceType">
                                        <option selected>يدوي (من قبل المعلم)</option>
                                        <option>كود حضور</option>
                                        <option>تلقائي (من Zoom)</option>
                                        <option>مختلط</option>
                                    </select>
                                </div>

                                <!-- Max Students -->
                                <div class="col-md-6">
                                    <label for="maxStudents" class="form-label">الحد الأقصى للطلاب</label>
                                    <input type="number" class="form-control" id="maxStudents" placeholder="غير محدود" min="1">
                                    <small class="text-muted">اتركه فارغًا لعدم التحديد</small>
                                </div>

                                <!-- Settings Checkboxes -->
                                <div class="col-md-12">
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="recordSession" checked>
                                        <label class="form-check-label" for="recordSession">
                                            تسجيل الجلسة تلقائيًا
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="allowChat" checked>
                                        <label class="form-check-label" for="allowChat">
                                            السماح بالمحادثة
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="sendNotification" checked>
                                        <label class="form-check-label" for="sendNotification">
                                            إرسال إشعار للطلاب
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="requireApproval">
                                        <label class="form-check-label" for="requireApproval">
                                            يتطلب موافقة المشرف
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Materials & Notes Card -->
                    <div class="card mb-4">
                        <div class="card-header bg-white">
                            <h5 class="mb-0 fw-bold">
                                <i class="bi bi-file-earmark me-2"></i>المواد والملاحظات
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <!-- Materials -->
                                <div class="col-md-12">
                                    <label class="form-label">المواد التعليمية</label>
                                    <div class="border rounded p-3 mb-2" class="min-h-100px">
                                        <p class="text-muted text-center mb-0">
                                            <i class="bi bi-cloud-upload fs-1 d-block mb-2"></i>
                                            اسحب الملفات هنا أو انقر للتحميل
                                        </p>
                                    </div>
                                    <button type="button" class="btn btn-light btn-sm">
                                        <i class="bi bi-paperclip me-1"></i>إضافة ملف
                                    </button>
                                </div>

                                <!-- Notes for Instructor -->
                                <div class="col-md-12">
                                    <label for="instructorNotes" class="form-label">ملاحظات للمعلم</label>
                                    <textarea class="form-control" id="instructorNotes" rows="3" placeholder="ملاحظات خاصة بالمعلم..."></textarea>
                                </div>

                                <!-- Admin Notes -->
                                <div class="col-md-12">
                                    <label for="adminNotes" class="form-label">ملاحظات إدارية</label>
                                    <textarea class="form-control" id="adminNotes" rows="2" placeholder="ملاحظات داخلية..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <button type="button" class="btn btn-light" onclick="history.back()">
                                    <i class="bi bi-x-circle me-2"></i>إلغاء
                                </button>
                                <div>
                                    <button type="button" class="btn btn-light me-2" data-bs-toggle="modal" data-bs-target="#previewModal">
                                        <i class="bi bi-eye me-2"></i>معاينة
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="bi bi-check-circle me-2"></i>حفظ الجلسة
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Footer -->
            <footer class="mt-auto py-3 text-center text-muted small">
                <p class="mb-0">&copy; 2025 IDARTI Live Academy. جميع الحقوق محفوظة.</p>
            </footer>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="../../assets/js/popper.min.js"></script>
    <script src="../../assets/js/bootstrap.min.js"></script>
    <script src="../../assets/js/custom.js"></script>
    
    <!-- Load Partials -->
    <script>
        fetch('../partials/sidebar_admin.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('sidebar-container').innerHTML = data;
            });

        fetch('../partials/navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar-container').innerHTML = data;
            });

        // Check if edit mode from URL
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('edit')) {
            document.getElementById('pageTitle').textContent = 'تعديل الجلسة';
            document.getElementById('pageMode').textContent = 'تعديل جلسة';
            // Load session data here...
        }

        // Form validation
        (function() {
            'use strict';
            const forms = document.querySelectorAll('.needs-validation');
            Array.from(forms).forEach(form => {
                form.addEventListener('submit', event => {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        })();
    </script>
    
    <!-- Create Zoom Link Modal -->
    <div class="modal fade" id="createZoomModal" tabindex="-1" aria-labelledby="createZoomModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="createZoomModalLabel"><i class="bi bi-camera-video me-2"></i>إنشاء رابط Zoom</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        سيتم إنشاء رابط Zoom جديد لهذه الجلسة باستخدام حساب المنصة.
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">عنوان الاجتماع</label>
                        <input type="text" class="form-control" value="الجلسة 3: مقدمة في JavaScript - الرياضيات المتقدمة">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">وصف الاجتماع</label>
                        <textarea class="form-control" rows="3">الجلسة الثالثة من دورة الرياضيات المتقدمة. سيتم شرح مقدمة في JavaScript وتطبيقاتها في الرياضيات.</textarea>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">التاريخ</label>
                            <input type="date" class="form-control" value="2024-11-15">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">الوقت</label>
                            <input type="time" class="form-control" value="18:00">
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">مدة الاجتماع (بالدقائق)</label>
                        <input type="number" class="form-control" value="120">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">كلمة مرور الاجتماع</label>
                        <div class="input-group">
                            <input type="text" class="form-control" value="123456">
                            <button class="btn btn-outline-secondary" type="button">
                                <i class="bi bi-arrow-repeat"></i>
                            </button>
                        </div>
                        <small class="text-muted">اترك فارغًا لإنشاء كلمة مرور تلقائية</small>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">خيارات إضافية</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="waitingRoom" checked>
                            <label class="form-check-label" for="waitingRoom">
                                تفعيل غرفة الانتظار
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="hostVideo" checked>
                            <label class="form-check-label" for="hostVideo">
                                تشغيل فيديو المضيف تلقائيًا
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="participantVideo">
                            <label class="form-check-label" for="participantVideo">
                                تشغيل فيديو المشاركين تلقائيًا
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="joinBeforeHost">
                            <label class="form-check-label" for="joinBeforeHost">
                                السماح بالانضمام قبل المضيف
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="muteParticipants" checked>
                            <label class="form-check-label" for="muteParticipants">
                                كتم صوت المشاركين عند الدخول
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary" onclick="createZoomLink()">إنشاء الرابط</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Preview Modal -->
    <div class="modal fade" id="previewModal" tabindex="-1" aria-labelledby="previewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="previewModalLabel"><i class="bi bi-eye me-2"></i>معاينة الجلسة</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="card mb-3">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">الجلسة 3: مقدمة في JavaScript</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>الدورة:</strong> الرياضيات المتقدمة</p>
                                    <p><strong>المدرس:</strong> د. أحمد محمد</p>
                                    <p><strong>النوع:</strong> جلسة مباشرة</p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>التاريخ:</strong> الثلاثاء 15 نوفمبر 2024</p>
                                    <p><strong>الوقت:</strong> 6:00 م - 8:00 م</p>
                                    <p><strong>المدة:</strong> ساعتان</p>
                                </div>
                            </div>
                            <hr>
                            <h6>الوصف</h6>
                            <p>في هذه الجلسة سنتعرف على أساسيات JavaScript وكيفية استخدامها في حل المسائل الرياضية. سنقوم بتطبيق عملي على كيفية كتابة الدوال والمعادلات الرياضية باستخدام JavaScript.</p>
                            
                            <h6>المتطلبات</h6>
                            <ul>
                                <li>حضور الجلسة السابقة</li>
                                <li>إكمال الواجب المنزلي</li>
                                <li>تحضير الأسئلة والاستفسارات</li>
                            </ul>
                            
                            <h6>رابط الاجتماع</h6>
                            <div class="alert alert-info">
                                <a href="https://zoom.us/j/123456789" target="_blank">https://zoom.us/j/123456789</a>
                                <p class="mb-0 mt-2"><small>كلمة المرور: 123456</small></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle me-2"></i>
                        هذه معاينة فقط. لم يتم حفظ البيانات بعد.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إغلاق</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        function createZoomLink() {
            // In a real application, this would make an API call to Zoom
            // For demo purposes, we'll just simulate the creation and update the field
            
            // Generate a random meeting ID
            const meetingId = Math.floor(100000000 + Math.random() * 900000000);
            const zoomLink = `https://zoom.us/j/${meetingId}`;
            
            // Update the meeting link field
            document.getElementById('meetingLink').value = zoomLink;
            
            // Close the modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('createZoomModal'));
            modal.hide();
            
            // Show success message
            alert('تم إنشاء رابط Zoom بنجاح');
        }
    </script>
</body>
</html>

