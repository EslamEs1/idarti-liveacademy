<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تفاصيل الالتحاق - IDARTI Live Academy</title>
    
    <!-- Bootstrap RTL CSS -->
    <link rel="stylesheet" href="../../assets/css/bootstrap.rtl.min.css">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Custom System CSS -->
    <link rel="stylesheet" href="../../assets/css/custom_system.css">
</head>
<body>
    <div class="d-flex">
        <!-- Sidebar -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <div class="content-wrapper">
            <!-- Navbar -->
            <div id="navbar-container"></div>

            <!-- Page Content -->
            <div class="container-fluid px-4 py-4">
                <!-- Breadcrumb -->
                <nav aria-label="breadcrumb" class="mb-4">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/system/dashboard/admin.html">لوحة التحكم</a></li>
                        <li class="breadcrumb-item"><a href="/system/enrollments/list-admin.html">الالتحاقات</a></li>
                        <li class="breadcrumb-item active">تفاصيل الالتحاق #EN-1024</li>
                    </ol>
                </nav>

                <!-- Enrollment Header Card -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <div class="d-flex align-items-center">
                                    <div class="avatar-sm d-flex align-items-center justify-content-center rounded-circle me-3" class="size-60 avatar-gradient-info">
                                        <i class="bi bi-person-fill text-white fs-3"></i>
                                    </div>
                                    <div>
                                        <h5 class="mb-1 fw-bold">محمد خالد</h5>
                                        <p class="text-muted mb-0">
                                            <i class="bi bi-envelope me-2"></i>mohammed@example.com
                                            <i class="bi bi-phone me-2 ms-3"></i>+966 50 123 4567
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 text-end">
                                <h6 class="text-muted mb-1">رقم الالتحاق</h6>
                                <h4 class="fw-bold">#EN-1024</h4>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="fw-bold mb-2">الرياضيات المتقدمة</h6>
                                <p class="text-muted mb-1">
                                    <i class="bi bi-person-badge me-2"></i>المدرس: د. أحمد محمد
                                </p>
                                <p class="text-muted mb-0">
                                    <i class="bi bi-calendar me-2"></i>تاريخ الالتحاق: 15 يناير 2025
                                </p>
                            </div>
                            <div class="col-md-6 text-end">
                                <span class="badge badge-success fs-6">نشط</span>
                                <span class="badge badge-success fs-6 ms-2">مدفوع كاملاً</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="d-flex gap-2 mb-4 flex-wrap">
                    <a href="/system/enrollments/form.html?edit=1024" class="btn btn-primary">
                        <i class="bi bi-pencil me-2"></i>تعديل الالتحاق
                    </a>
                    <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#freezeEnrollmentModal" data-enrollment-id="1" data-student-name="أحمد محمد">
                        <i class="bi bi-pause-circle me-2"></i>تجميد
                    </button>
                    <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#paymentManagementModal" data-enrollment-id="1" data-student-name="أحمد محمد">
                        <i class="bi bi-cash me-2"></i>إدارة الدفع
                    </button>
                    <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#sendMessageModal" data-enrollment-id="1" data-student-name="أحمد محمد">
                        <i class="bi bi-envelope me-2"></i>إرسال رسالة
                    </button>
                    <a href="/system/enrollments/print-detail.html?id=1" class="btn btn-light">
                        <i class="bi bi-printer me-2"></i>طباعة
                    </a>
                    <button class="btn btn-outline-danger ms-auto" data-bs-toggle="modal" data-bs-target="#cancelEnrollmentModal" data-enrollment-id="1" data-student-name="أحمد محمد">
                        <i class="bi bi-x-circle me-2"></i>إلغاء الالتحاق
                    </button>
                    <a href="/system/enrollments/list-admin.html" class="btn btn-light">
                        <i class="bi bi-arrow-right me-2"></i>رجوع
                    </a>
                </div>

                <div class="row g-4">
                    <!-- Main Content -->
                    <div class="col-lg-8">
                        <!-- Progress Card -->
                        <div class="card mb-4">
                            <div class="card-header bg-white">
                                <h6 class="mb-0 fw-bold">التقدم في الدورة</h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-4 text-center">
                                        <div class="mb-2">
                                            <div class="d-inline-flex align-items-center justify-content-center rounded-circle" class="size-100 avatar-gradient-success">
                                                <h3 class="mb-0 text-white fw-bold">75%</h3>
                                            </div>
                                        </div>
                                        <p class="text-muted mb-0">التقدم العام</p>
                                    </div>
                                    <div class="col-md-4 text-center">
                                        <div class="mb-2">
                                            <div class="d-inline-flex align-items-center justify-content-center rounded-circle" class="size-100 avatar-gradient-warning">
                                                <h3 class="mb-0 text-white fw-bold">95%</h3>
                                            </div>
                                        </div>
                                        <p class="text-muted mb-0">معدل الحضور</p>
                                    </div>
                                    <div class="col-md-4 text-center">
                                        <div class="mb-2">
                                            <div class="d-inline-flex align-items-center justify-content-center rounded-circle" class="size-100 avatar-gradient-primary-alt">
                                                <h3 class="mb-0 text-white fw-bold">92%</h3>
                                            </div>
                                        </div>
                                        <p class="text-muted mb-0">الدرجة</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Details -->
                        <div class="card mb-4">
                            <div class="card-header bg-white">
                                <h6 class="mb-0 fw-bold">تفاصيل الدفع</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-borderless">
                                        <tr>
                                            <td class="text-muted">سعر الدورة:</td>
                                            <td class="fw-semibold text-end">2,500 ر.س</td>
                                        </tr>
                                        <tr>
                                            <td class="text-muted">الخصم:</td>
                                            <td class="fw-semibold text-success text-end">- 0 ر.س</td>
                                        </tr>
                                        <tr>
                                            <td class="text-muted">المبلغ المدفوع:</td>
                                            <td class="fw-semibold text-success text-end">2,500 ر.س</td>
                                        </tr>
                                        <tr>
                                            <td class="text-muted">المبلغ المتبقي:</td>
                                            <td class="fw-semibold text-danger text-end">0 ر.س</td>
                                        </tr>
                                        <tr class="border-top">
                                            <td class="text-muted fw-bold">الحالة:</td>
                                            <td class="text-end">
                                                <span class="badge badge-success">مدفوع كاملاً</span>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Activity Timeline -->
                        <div class="card">
                            <div class="card-header bg-white">
                                <h6 class="mb-0 fw-bold">السجل والنشاطات</h6>
                            </div>
                            <div class="card-body">
                                <div class="timeline">
                                    <div class="timeline-item">
                                        <div class="timeline-marker bg-success"></div>
                                        <div class="timeline-content">
                                            <h6 class="mb-1">حضر الجلسة #24</h6>
                                            <p class="text-muted small mb-0">منذ 3 ساعات</p>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-marker bg-primary"></div>
                                        <div class="timeline-content">
                                            <h6 class="mb-1">حصل على 95% في الاختبار #3</h6>
                                            <p class="text-muted small mb-0">منذ يومين</p>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-marker bg-warning"></div>
                                        <div class="timeline-content">
                                            <h6 class="mb-1">تم دفع القسط الثاني</h6>
                                            <p class="text-muted small mb-0">منذ أسبوع</p>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-marker bg-info"></div>
                                        <div class="timeline-content">
                                            <h6 class="mb-1">تم تفعيل الالتحاق</h6>
                                            <p class="text-muted small mb-0">15 يناير 2025</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="col-lg-4">
                        <!-- Quick Info -->
                        <div class="card mb-4">
                            <div class="card-header bg-white">
                                <h6 class="mb-0 fw-bold">معلومات سريعة</h6>
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span class="text-muted">الجلسات المكتملة:</span>
                                    <span class="fw-semibold">24/32</span>
                                </div>
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span class="text-muted">الحضور:</span>
                                    <span class="badge badge-success">23/24</span>
                                </div>
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span class="text-muted">الغياب:</span>
                                    <span class="badge badge-danger">1</span>
                                </div>
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span class="text-muted">الاختبارات:</span>
                                    <span class="fw-semibold">3/5</span>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span class="text-muted">الواجبات:</span>
                                    <span class="fw-semibold">8/10</span>
                                </div>
                            </div>
                        </div>

                        <!-- Related Links -->
                        <div class="card">
                            <div class="card-header bg-white">
                                <h6 class="mb-0 fw-bold">روابط سريعة</h6>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <a href="/system/courses/detail-admin.html?id=1" class="btn btn-light text-start">
                                        <i class="bi bi-journal-richtext me-2"></i>صفحة الدورة
                                    </a>
                                    <a href="/system/users/detail-student.html?id=1" class="btn btn-light text-start">
                                        <i class="bi bi-person me-2"></i>ملف الطالب
                                    </a>
                                    <a href="/system/attendance/list-admin.html?student=1" class="btn btn-light text-start">
                                        <i class="bi bi-calendar-check me-2"></i>سجل الحضور
                                    </a>
                                    <a href="/system/billing/invoices.html?enrollment=1024" class="btn btn-light text-start">
                                        <i class="bi bi-receipt me-2"></i>الفواتير
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="mt-auto py-3 text-center text-muted small">
                <p class="mb-0">&copy; 2025 IDARTI Live Academy. جميع الحقوق محفوظة.</p>
            </footer>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="../../assets/js/popper.min.js"></script>
    <script src="../../assets/js/bootstrap.min.js"></script>
    <script src="../../assets/js/custom.js"></script>
    
    <!-- Load Partials -->
    <script>
        fetch('../partials/sidebar_admin.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('sidebar-container').innerHTML = data;
            });

        fetch('../partials/navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar-container').innerHTML = data;
            });
    </script>
    
    <!-- Freeze Enrollment Modal -->
    <div class="modal fade" id="freezeEnrollmentModal" tabindex="-1" aria-labelledby="freezeEnrollmentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title" id="freezeEnrollmentModalLabel"><i class="bi bi-pause-circle me-2"></i>تجميد الالتحاق</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>أنت على وشك تجميد التحاق الطالب <strong id="freezeStudentName">أحمد محمد</strong> في الدورة.</p>
                    
                    <div class="mb-3">
                        <label class="form-label">تاريخ بدء التجميد</label>
                        <input type="date" class="form-control" value="2024-10-28">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">تاريخ انتهاء التجميد (اختياري)</label>
                        <input type="date" class="form-control">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">سبب التجميد</label>
                        <select class="form-select">
                            <option>طلب الطالب</option>
                            <option>مشكلة في الدفع</option>
                            <option>ظروف صحية</option>
                            <option>سفر</option>
                            <option>سبب آخر</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">ملاحظات</label>
                        <textarea class="form-control" rows="3" placeholder="أضف ملاحظات حول التجميد..."></textarea>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="notifyFreeze" checked>
                        <label class="form-check-label" for="notifyFreeze">
                            إرسال إشعار للطالب
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-warning">تأكيد التجميد</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Payment Management Modal -->
    <div class="modal fade" id="paymentManagementModal" tabindex="-1" aria-labelledby="paymentManagementModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="paymentManagementModalLabel"><i class="bi bi-cash me-2"></i>إدارة الدفع</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">معلومات الدفع</h6>
                                </div>
                                <div class="card-body">
                                    <p><strong>الطالب:</strong> <span id="paymentStudentName">أحمد محمد</span></p>
                                    <p><strong>الدورة:</strong> الرياضيات المتقدمة</p>
                                    <p><strong>إجمالي المبلغ:</strong> 1,500 ر.س</p>
                                    <p><strong>المدفوع:</strong> 500 ر.س</p>
                                    <p><strong>المتبقي:</strong> 1,000 ر.س</p>
                                    <p><strong>حالة الدفع:</strong> <span class="badge bg-warning">دفعة أولى</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">إجراءات سريعة</h6>
                                </div>
                                <div class="card-body">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary text-start" id="recordPaymentBtn">
                                            <i class="bi bi-plus-circle me-2"></i>تسجيل دفعة
                                        </button>
                                        <button class="btn btn-light text-start" id="sendReminderBtn">
                                            <i class="bi bi-bell me-2"></i>إرسال تذكير
                                        </button>
                                        <button class="btn btn-light text-start" id="schedulePaymentBtn">
                                            <i class="bi bi-calendar me-2"></i>جدولة دفعة
                                        </button>
                                        <a href="/system/billing/invoice-detail-admin.html?enrollment_id=1" class="btn btn-light text-start">
                                            <i class="bi bi-file-earmark-text me-2"></i>عرض الفاتورة
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="paymentHistorySection">
                        <h6 class="mb-3">سجل الدفعات</h6>
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>#</th>
                                        <th>التاريخ</th>
                                        <th>المبلغ</th>
                                        <th>طريقة الدفع</th>
                                        <th>الحالة</th>
                                        <th>ملاحظات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>15 أكتوبر 2024</td>
                                        <td>500 ر.س</td>
                                        <td>تحويل بنكي</td>
                                        <td><span class="badge bg-success">مكتمل</span></td>
                                        <td>دفعة أولى</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div id="recordPaymentSection" class="mt-4 d-none">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">تسجيل دفعة جديدة</h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">المبلغ</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" placeholder="500">
                                            <span class="input-group-text">ر.س</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">تاريخ الدفع</label>
                                        <input type="date" class="form-control" value="2024-10-28">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">طريقة الدفع</label>
                                        <select class="form-select">
                                            <option>تحويل بنكي</option>
                                            <option>بطاقة ائتمان</option>
                                            <option>نقدي</option>
                                            <option>أخرى</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">الحالة</label>
                                        <select class="form-select">
                                            <option>مكتمل</option>
                                            <option>قيد المعالجة</option>
                                            <option>بانتظار التأكيد</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">ملاحظات</label>
                                        <textarea class="form-control" rows="2" placeholder="أضف ملاحظات حول الدفعة..."></textarea>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="sendReceipt" checked>
                                            <label class="form-check-label" for="sendReceipt">
                                                إرسال إيصال للطالب
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="button" class="btn btn-light" id="cancelRecordPayment">إلغاء</button>
                                        <button type="button" class="btn btn-primary">تسجيل الدفعة</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="reminderSection" class="mt-4 d-none">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">إرسال تذكير دفع</h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">نوع التذكير</label>
                                        <select class="form-select">
                                            <option>بريد إلكتروني</option>
                                            <option>رسالة نصية</option>
                                            <option>كلاهما</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">المبلغ المطلوب</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="500">
                                            <span class="input-group-text">ر.س</span>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">نص التذكير</label>
                                        <textarea class="form-control" rows="3">عزيزي الطالب، نود تذكيرك بموعد الدفعة المستحقة بقيمة 500 ر.س لدورة الرياضيات المتقدمة. نرجو سداد المبلغ في أقرب وقت ممكن.</textarea>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="button" class="btn btn-light" id="cancelReminder">إلغاء</button>
                                        <button type="button" class="btn btn-primary">إرسال التذكير</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="scheduleSection" class="mt-4 d-none">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">جدولة دفعة</h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">تاريخ الدفعة</label>
                                        <input type="date" class="form-control" value="2024-11-15">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">المبلغ</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="500">
                                            <span class="input-group-text">ر.س</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">طريقة الدفع المفضلة</label>
                                        <select class="form-select">
                                            <option>تحويل بنكي</option>
                                            <option>بطاقة ائتمان</option>
                                            <option>نقدي</option>
                                            <option>أخرى</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">إرسال تذكير قبل</label>
                                        <select class="form-select">
                                            <option>يوم واحد</option>
                                            <option>3 أيام</option>
                                            <option>أسبوع</option>
                                            <option>لا ترسل تذكير</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">ملاحظات</label>
                                        <textarea class="form-control" rows="2" placeholder="أضف ملاحظات حول الدفعة المجدولة..."></textarea>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="button" class="btn btn-light" id="cancelSchedule">إلغاء</button>
                                        <button type="button" class="btn btn-primary">حفظ الجدولة</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إغلاق</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Send Message Modal -->
    <div class="modal fade" id="sendMessageModal" tabindex="-1" aria-labelledby="sendMessageModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sendMessageModalLabel"><i class="bi bi-envelope me-2"></i>إرسال رسالة</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>إرسال رسالة إلى الطالب <strong id="messageStudentName">أحمد محمد</strong>.</p>
                    
                    <div class="mb-3">
                        <label class="form-label">نوع الرسالة</label>
                        <select class="form-select">
                            <option>بريد إلكتروني</option>
                            <option>رسالة نصية</option>
                            <option>إشعار داخل النظام</option>
                            <option>كل ما سبق</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">الموضوع</label>
                        <input type="text" class="form-control" placeholder="أدخل موضوع الرسالة...">
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">نص الرسالة</label>
                        <textarea class="form-control" rows="5" placeholder="أدخل نص الرسالة..."></textarea>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="saveTemplate">
                        <label class="form-check-label" for="saveTemplate">
                            حفظ كقالب
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary">إرسال الرسالة</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Cancel Enrollment Modal -->
    <div class="modal fade" id="cancelEnrollmentModal" tabindex="-1" aria-labelledby="cancelEnrollmentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="cancelEnrollmentModalLabel"><i class="bi bi-x-circle me-2"></i>إلغاء الالتحاق</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle me-2"></i>
                        أنت على وشك إلغاء التحاق الطالب <strong id="cancelStudentName">أحمد محمد</strong> في الدورة.
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">سبب الإلغاء</label>
                        <select class="form-select">
                            <option>طلب الطالب</option>
                            <option>عدم الالتزام بالدفع</option>
                            <option>عدم الالتزام بالحضور</option>
                            <option>مشاكل سلوكية</option>
                            <option>سبب آخر</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">سياسة الاسترداد</label>
                        <select class="form-select" id="refundPolicy">
                            <option value="none">لا يوجد استرداد</option>
                            <option value="partial">استرداد جزئي</option>
                            <option value="full">استرداد كامل</option>
                        </select>
                    </div>
                    
                    <div id="refundAmountField" class="mb-3 d-none">
                        <label class="form-label">مبلغ الاسترداد</label>
                        <div class="input-group">
                            <input type="number" class="form-control" placeholder="500">
                            <span class="input-group-text">ر.س</span>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">ملاحظات إضافية</label>
                        <textarea class="form-control" rows="3" placeholder="أضف ملاحظات حول سبب الإلغاء..."></textarea>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="notifyCancellation" checked>
                        <label class="form-check-label" for="notifyCancellation">
                            إرسال إشعار للطالب
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">تراجع</button>
                    <button type="button" class="btn btn-danger">تأكيد الإلغاء</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Handle modal data
        document.addEventListener('DOMContentLoaded', function() {
            // Freeze Enrollment Modal
            var freezeModal = document.getElementById('freezeEnrollmentModal');
            freezeModal?.addEventListener('show.bs.modal', function(event) {
                var button = event.relatedTarget;
                var enrollmentId = button.getAttribute('data-enrollment-id');
                var studentName = button.getAttribute('data-student-name');
                document.getElementById('freezeStudentName').textContent = studentName;
            });
            
            // Payment Management Modal
            var paymentModal = document.getElementById('paymentManagementModal');
            paymentModal?.addEventListener('show.bs.modal', function(event) {
                var button = event.relatedTarget;
                var enrollmentId = button.getAttribute('data-enrollment-id');
                var studentName = button.getAttribute('data-student-name');
                document.getElementById('paymentStudentName').textContent = studentName;
            });
            
            // Send Message Modal
            var messageModal = document.getElementById('sendMessageModal');
            messageModal?.addEventListener('show.bs.modal', function(event) {
                var button = event.relatedTarget;
                var enrollmentId = button.getAttribute('data-enrollment-id');
                var studentName = button.getAttribute('data-student-name');
                document.getElementById('messageStudentName').textContent = studentName;
            });
            
            // Cancel Enrollment Modal
            var cancelModal = document.getElementById('cancelEnrollmentModal');
            cancelModal?.addEventListener('show.bs.modal', function(event) {
                var button = event.relatedTarget;
                var enrollmentId = button.getAttribute('data-enrollment-id');
                var studentName = button.getAttribute('data-student-name');
                document.getElementById('cancelStudentName').textContent = studentName;
            });
            
            // Handle refund policy change
            var refundPolicy = document.getElementById('refundPolicy');
            refundPolicy?.addEventListener('change', function() {
                var refundAmountField = document.getElementById('refundAmountField');
                
                if (this.value === 'none') {
                    refundAmountField.classList.add('d-none');
                } else {
                    refundAmountField.classList.remove('d-none');
                }
            });
            
            // Payment management sections
            var recordPaymentBtn = document.getElementById('recordPaymentBtn');
            var sendReminderBtn = document.getElementById('sendReminderBtn');
            var schedulePaymentBtn = document.getElementById('schedulePaymentBtn');
            
            var recordPaymentSection = document.getElementById('recordPaymentSection');
            var reminderSection = document.getElementById('reminderSection');
            var scheduleSection = document.getElementById('scheduleSection');
            
            // Show record payment section
            recordPaymentBtn?.addEventListener('click', function() {
                recordPaymentSection.classList.remove('d-none');
                reminderSection.classList.add('d-none');
                scheduleSection.classList.add('d-none');
                
                recordPaymentBtn.classList.remove('btn-light');
                recordPaymentBtn.classList.add('btn-primary');
                
                sendReminderBtn.classList.remove('btn-primary');
                sendReminderBtn.classList.add('btn-light');
                
                schedulePaymentBtn.classList.remove('btn-primary');
                schedulePaymentBtn.classList.add('btn-light');
            });
            
            // Show send reminder section
            sendReminderBtn?.addEventListener('click', function() {
                recordPaymentSection.classList.add('d-none');
                reminderSection.classList.remove('d-none');
                scheduleSection.classList.add('d-none');
                
                recordPaymentBtn.classList.remove('btn-primary');
                recordPaymentBtn.classList.add('btn-light');
                
                sendReminderBtn.classList.remove('btn-light');
                sendReminderBtn.classList.add('btn-primary');
                
                schedulePaymentBtn.classList.remove('btn-primary');
                schedulePaymentBtn.classList.add('btn-light');
            });
            
            // Show schedule payment section
            schedulePaymentBtn?.addEventListener('click', function() {
                recordPaymentSection.classList.add('d-none');
                reminderSection.classList.add('d-none');
                scheduleSection.classList.remove('d-none');
                
                recordPaymentBtn.classList.remove('btn-primary');
                recordPaymentBtn.classList.add('btn-light');
                
                sendReminderBtn.classList.remove('btn-primary');
                sendReminderBtn.classList.add('btn-light');
                
                schedulePaymentBtn.classList.remove('btn-light');
                schedulePaymentBtn.classList.add('btn-primary');
            });
            
            // Cancel buttons
            document.getElementById('cancelRecordPayment')?.addEventListener('click', function() {
                recordPaymentSection.classList.add('d-none');
                recordPaymentBtn.classList.remove('btn-primary');
                recordPaymentBtn.classList.add('btn-light');
            });
            
            document.getElementById('cancelReminder')?.addEventListener('click', function() {
                reminderSection.classList.add('d-none');
                sendReminderBtn.classList.remove('btn-primary');
                sendReminderBtn.classList.add('btn-light');
            });
            
            document.getElementById('cancelSchedule')?.addEventListener('click', function() {
                scheduleSection.classList.add('d-none');
                schedulePaymentBtn.classList.remove('btn-primary');
                schedulePaymentBtn.classList.add('btn-light');
            });
        });
    </script>
</body>
</html>
