<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تفاصيل الفاتورة - IDARTI Live Academy</title>
    
    <!-- Bootstrap RTL CSS -->
    <link rel="stylesheet" href="../../assets/css/bootstrap.rtl.min.css">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Custom System CSS -->
    <link rel="stylesheet" href="../../assets/css/custom_system.css">
</head>
<body>
    <div class="d-flex">
        <!-- Sidebar -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <div class="content-wrapper">
            <!-- Navbar -->
            <div id="navbar-container"></div>

            <!-- Page Content -->
            <div class="container-fluid px-4 py-4">
                <!-- Breadcrumb -->
                <nav aria-label="breadcrumb" class="mb-4">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/system/dashboard/admin.html">لوحة التحكم</a></li>
                        <li class="breadcrumb-item"><a href="/system/billing/list-admin.html">الفواتير</a></li>
                        <li class="breadcrumb-item active">تفاصيل الفاتورة #INV-2024-001</li>
                    </ol>
                </nav>

                <!-- Page Header -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h4 class="mb-1 fw-bold">تفاصيل الفاتورة #INV-2024-001</h4>
                        <p class="text-muted mb-0">معلومات كاملة عن الفاتورة والمدفوعات</p>
                    </div>
                    <div>
                        <a href="/system/billing/print-invoice.html?id=1" class="btn btn-primary me-2">
                            <i class="bi bi-printer me-2"></i>طباعة
                        </a>
                        <a href="/system/billing/download-pdf.html?id=1" class="btn btn-success me-2">
                            <i class="bi bi-file-earmark-pdf me-2"></i>PDF
                        </a>
                        <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#paymentModal">
                            <i class="bi bi-cash-stack me-2"></i>تسجيل دفعة
                        </button>
                    </div>
                </div>

                <div class="row">
                    <!-- Invoice Details -->
                    <div class="col-lg-8">
                        <!-- Invoice Header Card -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-receipt me-2"></i>معلومات الفاتورة</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="d-flex align-items-center mb-3">
                                            <div class="size-60 avatar-gradient-info rounded-circle d-flex align-items-center justify-content-center me-3">
                                                <i class="bi bi-person-fill text-white fs-4"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-0 fw-bold">محمد أحمد علي</h6>
                                                <small class="text-muted">طالب</small>
                                            </div>
                                        </div>
                                        <div class="small text-muted">
                                            <p class="mb-1"><i class="bi bi-envelope me-2"></i>mohamed.ahmed@example.com</p>
                                            <p class="mb-0"><i class="bi bi-phone me-2"></i>+966 50 123 4567</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <div class="d-flex justify-content-between mb-2">
                                            <span class="text-muted">رقم الفاتورة:</span>
                                            <span class="fw-bold">INV-2024-001</span>
                                        </div>
                                        <div class="d-flex justify-content-between mb-2">
                                            <span class="text-muted">تاريخ الإصدار:</span>
                                            <span>2024-10-15</span>
                                        </div>
                                        <div class="d-flex justify-content-between mb-2">
                                            <span class="text-muted">تاريخ الاستحقاق:</span>
                                            <span class="text-danger">2024-11-15</span>
                                        </div>
                                        <div class="d-flex justify-content-between">
                                            <span class="text-muted">الحالة:</span>
                                            <span class="badge badge-warning">متأخرة</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Invoice Items -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-list-ul me-2"></i>عناصر الفاتورة</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>الدورة / الخدمة</th>
                                                <th class="text-center">الكمية</th>
                                                <th class="text-end">السعر</th>
                                                <th class="text-end">الإجمالي</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <div class="fw-bold">الرياضيات المتقدمة</div>
                                                    <small class="text-muted">اشتراك 3 أشهر</small>
                                                </td>
                                                <td class="text-center">1</td>
                                                <td class="text-end">1,500 ر.س</td>
                                                <td class="text-end">1,500 ر.س</td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="fw-bold">الفيزياء التطبيقية</div>
                                                    <small class="text-muted">اشتراك 3 أشهر</small>
                                                </td>
                                                <td class="text-center">1</td>
                                                <td class="text-end">1,200 ر.س</td>
                                                <td class="text-end">1,200 ر.س</td>
                                            </tr>
                                        </tbody>
                                        <tfoot>
                                            <tr class="border-top">
                                                <td colspan="3" class="text-end fw-bold">المجموع الفرعي:</td>
                                                <td class="text-end">2,700 ر.س</td>
                                            </tr>
                                            <tr>
                                                <td colspan="3" class="text-end text-success">
                                                    <i class="bi bi-tag-fill me-2"></i>خصم (10%):
                                                </td>
                                                <td class="text-end text-success">-270 ر.س</td>
                                            </tr>
                                            <tr>
                                                <td colspan="3" class="text-end">ضريبة القيمة المضافة (15%):</td>
                                                <td class="text-end">364.50 ر.س</td>
                                            </tr>
                                            <tr class="border-top">
                                                <td colspan="3" class="text-end fw-bold fs-5">الإجمالي النهائي:</td>
                                                <td class="text-end fw-bold fs-5 text-primary">2,794.50 ر.س</td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Payment History -->
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-clock-history me-2"></i>سجل المدفوعات</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>التاريخ</th>
                                                <th>المبلغ</th>
                                                <th>طريقة الدفع</th>
                                                <th>الحالة</th>
                                                <th>ملاحظات</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>2024-10-20</td>
                                                <td class="fw-bold">1,000 ر.س</td>
                                                <td><i class="bi bi-credit-card me-2"></i>بطاقة ائتمان</td>
                                                <td><span class="badge badge-success">مكتمل</span></td>
                                                <td>دفعة جزئية</td>
                                            </tr>
                                            <tr>
                                                <td colspan="5" class="text-center text-muted">
                                                    المتبقي: <span class="fw-bold text-danger">1,794.50 ر.س</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar Actions -->
                    <div class="col-lg-4">
                        <!-- Payment Summary -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-wallet2 me-2"></i>ملخص الدفع</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span class="text-muted">إجمالي الفاتورة:</span>
                                    <span class="fw-bold">2,794.50 ر.س</span>
                                </div>
                                <div class="d-flex justify-content-between mb-3 pb-3 border-bottom">
                                    <span class="text-muted">المدفوع:</span>
                                    <span class="fw-bold text-success">1,000 ر.س</span>
                                </div>
                                <div class="d-flex justify-content-between mb-3">
                                    <span class="fw-bold">المتبقي:</span>
                                    <span class="fw-bold fs-5 text-danger">1,794.50 ر.س</span>
                                </div>
                                <div class="progress mb-3 progress-md">
                                    <div class="progress-bar bg-success w-35" role="progressbar"></div>
                                </div>
                                <small class="text-muted">تم دفع 35% من الفاتورة</small>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-lightning-fill me-2"></i>إجراءات سريعة</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#paymentModal">
                                        <i class="bi bi-cash-stack me-2"></i>تسجيل دفعة
                                    </button>
                                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reminderModal">
                                        <i class="bi bi-send me-2"></i>إرسال تذكير
                                    </button>
                                    <a href="/system/billing/edit-invoice.html?id=1" class="btn btn-warning">
                                        <i class="bi bi-pencil me-2"></i>تعديل الفاتورة
                                    </a>
                                    <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#cancelModal">
                                        <i class="bi bi-x-circle me-2"></i>إلغاء الفاتورة
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Notes -->
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-sticky me-2"></i>ملاحظات</h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-warning mb-3">
                                    <i class="bi bi-exclamation-triangle me-2"></i>
                                    الفاتورة متأخرة 5 أيام
                                </div>
                                <textarea class="form-control" rows="4" placeholder="إضافة ملاحظة..."></textarea>
                                <button class="btn btn-sm btn-primary mt-2 w-100" id="addNoteBtn">
                                    <i class="bi bi-plus-circle me-2"></i>إضافة ملاحظة
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal fade" id="paymentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-cash-stack me-2"></i>تسجيل دفعة جديدة</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label class="form-label">المبلغ المدفوع</label>
                            <input type="number" class="form-control" value="1794.50" step="0.01">
                            <small class="text-muted">المتبقي: 1,794.50 ر.س</small>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">طريقة الدفع</label>
                            <select class="form-select">
                                <option>بطاقة ائتمان</option>
                                <option>تحويل بنكي</option>
                                <option>نقدي</option>
                                <option>محفظة إلكترونية</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">تاريخ الدفع</label>
                            <input type="date" class="form-control" value="2024-10-28">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">رقم المرجع / الإيصال</label>
                            <input type="text" class="form-control" placeholder="REF-123456">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ملاحظات</label>
                            <textarea class="form-control" rows="3" placeholder="ملاحظات إضافية..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-success">
                        <i class="bi bi-check-circle me-2"></i>تسجيل الدفعة
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reminder Modal -->
    <div class="modal fade" id="reminderModal" tabindex="-1" aria-labelledby="reminderModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reminderModalLabel"><i class="bi bi-envelope me-2"></i>إرسال تذكير دفع</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">نوع التذكير</label>
                        <select class="form-select">
                            <option>تذكير أول</option>
                            <option selected>تذكير ثاني</option>
                            <option>تذكير نهائي</option>
                            <option>إشعار تأخير</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">طريقة الإرسال</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="emailReminder" checked>
                            <label class="form-check-label" for="emailReminder">بريد إلكتروني</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="smsReminder" checked>
                            <label class="form-check-label" for="smsReminder">رسالة نصية</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="pushReminder">
                            <label class="form-check-label" for="pushReminder">إشعار تطبيق</label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">نص الرسالة</label>
                        <textarea class="form-control" rows="3">تذكير بدفع الفاتورة رقم INV-2024-001 بمبلغ 1,500.00 ر.س. يرجى سداد المبلغ قبل تاريخ 2024-11-15 لتجنب رسوم التأخير. شكراً لتعاونكم.</textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">إرسال التذكير</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cancel Invoice Modal -->
    <div class="modal fade" id="cancelModal" tabindex="-1" aria-labelledby="cancelModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="cancelModalLabel"><i class="bi bi-exclamation-triangle me-2"></i>إلغاء الفاتورة</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        هذا الإجراء لا يمكن التراجع عنه. سيتم إلغاء الفاتورة بشكل نهائي.
                    </div>
                    
                    <p>هل أنت متأكد من رغبتك في إلغاء الفاتورة رقم <strong>INV-2024-001</strong>؟</p>
                    
                    <div class="mb-3">
                        <label class="form-label">سبب الإلغاء</label>
                        <select class="form-select">
                            <option>خطأ في البيانات</option>
                            <option>إلغاء الخدمة</option>
                            <option>تم إصدار فاتورة بديلة</option>
                            <option>سبب آخر</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">ملاحظات إضافية</label>
                        <textarea class="form-control" rows="3" placeholder="اكتب سبب الإلغاء هنا..."></textarea>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="notifyCustomer">
                        <label class="form-check-label" for="notifyCustomer">
                            إرسال إشعار للعميل بإلغاء الفاتورة
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">تراجع</button>
                    <button type="button" class="btn btn-danger">تأكيد الإلغاء</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="../../assets/js/bootstrap.min.js"></script>
    <!-- Load Partials -->
    <script src="../../assets/js/custom.js"></script>
    
    <script>
        // Add note functionality
        document.getElementById('addNoteBtn').addEventListener('click', function() {
            const noteText = document.querySelector('textarea[placeholder="إضافة ملاحظة..."]').value;
            if (noteText.trim() !== '') {
                alert('تم إضافة الملاحظة بنجاح');
                document.querySelector('textarea[placeholder="إضافة ملاحظة..."]').value = '';
            } else {
                alert('الرجاء كتابة ملاحظة قبل الإضافة');
            }
        });
    </script>
</body>
</html>

