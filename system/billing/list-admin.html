<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة الفواتير والمدفوعات - IDARTI Live Academy</title>
    
    <!-- Bootstrap RTL CSS -->
    <link rel="stylesheet" href="../../assets/css/bootstrap.rtl.min.css">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Custom System CSS -->
    <link rel="stylesheet" href="../../assets/css/custom_system.css">
</head>
<body>
    <div class="d-flex">
        <!-- Sidebar -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <div class="content-wrapper">
            <!-- Navbar -->
            <div id="navbar-container"></div>

            <!-- Page Content -->
            <div class="container-fluid px-4 py-4">
                <!-- Breadcrumb -->
                <nav aria-label="breadcrumb" class="mb-4">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/system/dashboard/admin.html">لوحة التحكم</a></li>
                        <li class="breadcrumb-item active">إدارة الفواتير والمدفوعات</li>
                    </ol>
                </nav>

                <!-- Page Header -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h4 class="mb-1 fw-bold">إدارة الفواتير والمدفوعات</h4>
                        <p class="text-muted mb-0">عرض وإدارة جميع الفواتير والمدفوعات</p>
                    </div>
                    <div>
                        <a href="/system/billing/create-invoice.html" class="btn btn-primary me-2">
                            <i class="bi bi-plus-circle me-2"></i>إنشاء فاتورة
                        </a>
                        <a href="/system/billing/export-excel.html" class="btn btn-light">
                            <i class="bi bi-file-earmark-excel me-2"></i>تصدير Excel
                        </a>
                    </div>
                </div>

                <!-- Statistics Cards -->
                <div class="row g-3 mb-4">
                    <div class="col-lg-3 col-md-6">
                        <div class="card stat-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <p class="text-muted mb-2">إجمالي الفواتير</p>
                                        <h3 class="mb-0 fw-bold">247</h3>
                                        <small class="text-primary">
                                            <i class="bi bi-receipt me-1"></i>فاتورة
                                        </small>
                                    </div>
                                    <div class="stat-icon bg-primary-light">
                                        <i class="bi bi-receipt text-primary"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6">
                        <div class="card stat-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <p class="text-muted mb-2">إجمالي المدفوعات</p>
                                        <h3 class="mb-0 fw-bold">156K ريال</h3>
                                        <small class="text-success">
                                            <i class="bi bi-arrow-up me-1"></i>+18% الشهر
                                        </small>
                                    </div>
                                    <div class="stat-icon bg-success-light">
                                        <i class="bi bi-cash-coin text-success"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6">
                        <div class="card stat-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <p class="text-muted mb-2">المتأخرات</p>
                                        <h3 class="mb-0 fw-bold">23</h3>
                                        <small class="text-danger">
                                            <i class="bi bi-exclamation-triangle me-1"></i>فاتورة
                                        </small>
                                    </div>
                                    <div class="stat-icon bg-danger-light">
                                        <i class="bi bi-exclamation-triangle text-danger"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6">
                        <div class="card stat-card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <p class="text-muted mb-2">معدل الاستلام</p>
                                        <h3 class="mb-0 fw-bold">92%</h3>
                                        <small class="text-success">
                                            <i class="bi bi-check-circle me-1"></i>ممتاز
                                        </small>
                                    </div>
                                    <div class="stat-icon bg-info-light">
                                        <i class="bi bi-pie-chart text-info"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filter Card -->
                <div class="card mb-4">
                    <div class="card-body">
                        <form class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label">بحث</label>
                                <input type="text" class="form-control" placeholder="رقم الفاتورة، الطالب...">
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">الحالة</label>
                                <select class="form-select">
                                    <option selected>جميع الحالات</option>
                                    <option>مدفوع</option>
                                    <option>جزئي</option>
                                    <option>متأخر</option>
                                    <option>ملغي</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">الفترة</label>
                                <select class="form-select">
                                    <option selected>جميع الفترات</option>
                                    <option>هذا الشهر</option>
                                    <option>آخر 3 أشهر</option>
                                    <option>هذا العام</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">القيمة</label>
                                <select class="form-select">
                                    <option selected>الكل</option>
                                    <option>أقل من 500</option>
                                    <option>500 - 1000</option>
                                    <option>أكثر من 1000</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">&nbsp;</label>
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="bi bi-search me-2"></i>بحث
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Invoices Table -->
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">الفواتير</h6>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>رقم الفاتورة</th>
                                        <th>الطالب</th>
                                        <th>الدورة</th>
                                        <th class="text-center">المبلغ</th>
                                        <th class="text-center">المدفوع</th>
                                        <th class="text-center">المتبقي</th>
                                        <th class="text-center">تاريخ الإصدار</th>
                                        <th class="text-center">آخر دفعة</th>
                                        <th class="text-center">الحالة</th>
                                        <th class="text-center">الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="table-danger">
                                        <td>
                                            <span class="fw-semibold">INV-2025-001</span>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="user-avatar me-2">
                                                    <i class="bi bi-person-fill"></i>
                                                </div>
                                                <span class="fw-semibold">محمد أحمد</span>
                                            </div>
                                        </td>
                                        <td>الرياضيات المتقدمة</td>
                                        <td class="text-center">
                                            <span class="fw-bold">1,500 ريال</span>
                                        </td>
                                        <td class="text-center">
                                            <span class="text-muted">0 ريال</span>
                                        </td>
                                        <td class="text-center">
                                            <span class="fw-bold text-danger">1,500 ريال</span>
                                        </td>
                                        <td class="text-center">15 يناير 2025</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">
                                            <span class="badge badge-danger">متأخر</span>
                                        </td>
                                        <td class="text-center">
                                            <div class="btn-group btn-group-sm">
                                                <a href="/system/billing/detail-admin.html?id=1" class="btn btn-light" title="عرض">
                                                    <i class="bi bi-eye"></i>
                                                </a>
                                                <button class="btn btn-light" title="إرسال تذكير" data-bs-toggle="modal" data-bs-target="#reminderModal">
                                                    <i class="bi bi-envelope"></i>
                                                </button>
                                                <button class="btn btn-success" title="تسجيل دفعة" data-bs-toggle="modal" data-bs-target="#paymentModal">
                                                    <i class="bi bi-cash-coin text-white"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr class="table-success">
                                        <td>
                                            <span class="fw-semibold">INV-2025-002</span>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="user-avatar me-2">
                                                    <i class="bi bi-person-fill"></i>
                                                </div>
                                                <span class="fw-semibold">فاطمة علي</span>
                                            </div>
                                        </td>
                                        <td>اللغة العربية</td>
                                        <td class="text-center">
                                            <span class="fw-bold">800 ريال</span>
                                        </td>
                                        <td class="text-center">
                                            <span class="fw-bold text-success">800 ريال</span>
                                        </td>
                                        <td class="text-center">
                                            <span class="text-success">0 ريال</span>
                                        </td>
                                        <td class="text-center">20 يناير 2025</td>
                                        <td class="text-center">25 يناير 2025</td>
                                        <td class="text-center">
                                            <span class="badge badge-success">مدفوع</span>
                                        </td>
                                        <td class="text-center">
                                            <div class="btn-group btn-group-sm">
                                                <a href="/system/billing/detail-admin.html?id=2" class="btn btn-light" title="عرض">
                                                    <i class="bi bi-eye"></i>
                                                </a>
                                                <a href="/system/billing/print-invoice.html?id=2" class="btn btn-light" title="طباعة">
                                                    <i class="bi bi-printer"></i>
                                                </a>
                                                <a href="/system/billing/download-pdf.html?id=2" class="btn btn-light" title="تحميل PDF">
                                                    <i class="bi bi-file-pdf"></i>
                                                </a>
                                            </div>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>
                                            <span class="fw-semibold">INV-2025-003</span>
                                        </td>
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="user-avatar me-2">
                                                    <i class="bi bi-person-fill"></i>
                                                </div>
                                                <span class="fw-semibold">خالد حسن</span>
                                            </div>
                                        </td>
                                        <td>الكيمياء العضوية</td>
                                        <td class="text-center">
                                            <span class="fw-bold">1,200 ريال</span>
                                        </td>
                                        <td class="text-center">
                                            <span class="fw-bold text-primary">600 ريال</span>
                                        </td>
                                        <td class="text-center">
                                            <span class="fw-bold text-warning">600 ريال</span>
                                        </td>
                                        <td class="text-center">25 يناير 2025</td>
                                        <td class="text-center">15 فبراير 2025</td>
                                        <td class="text-center">
                                            <span class="badge badge-warning">جزئي</span>
                                        </td>
                                        <td class="text-center">
                                            <div class="btn-group btn-group-sm">
                                                <a href="/system/billing/detail-admin.html?id=3" class="btn btn-light" title="عرض">
                                                    <i class="bi bi-eye"></i>
                                                </a>
                                                <button class="btn btn-light" title="تسجيل دفعة" data-bs-toggle="modal" data-bs-target="#paymentModal">
                                                    <i class="bi bi-cash-coin"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="card-footer bg-white">
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">عرض 3 من أصل 247 فاتورة</small>
                            <nav>
                                <ul class="pagination pagination-sm mb-0">
                                    <li class="page-item disabled">
                                        <a class="page-link" href="/system/billing/list-admin.html?page=1">السابق</a>
                                    </li>
                                    <li class="page-item active"><a class="page-link" href="/system/billing/list-admin.html?page=1">1</a></li>
                                    <li class="page-item"><a class="page-link" href="/system/billing/list-admin.html?page=2">2</a></li>
                                    <li class="page-item"><a class="page-link" href="/system/billing/list-admin.html?page=3">3</a></li>
                                    <li class="page-item">
                                        <a class="page-link" href="/system/billing/list-admin.html?page=2">التالي</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="mt-auto py-3 text-center text-muted small">
                <p class="mb-0">&copy; 2025 IDARTI Live Academy. جميع الحقوق محفوظة.</p>
            </footer>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="../../assets/js/popper.min.js"></script>
    <script src="../../assets/js/bootstrap.min.js"></script>
    <script src="../../assets/js/custom.js"></script>
    
    <!-- Load Partials -->
    <script>
        fetch('../partials/sidebar_admin.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('sidebar-container').innerHTML = data;
            });

        fetch('../partials/navbar.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar-container').innerHTML = data;
            });
    </script>
    
    <!-- Payment Modal -->
    <div class="modal fade" id="paymentModal" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="paymentModalLabel"><i class="bi bi-cash-stack me-2"></i>تسجيل دفعة جديدة</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label class="form-label">المبلغ المدفوع</label>
                            <input type="number" class="form-control" value="1500.00" step="0.01">
                            <small class="text-muted">المتبقي: 1,500.00 ر.س</small>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">طريقة الدفع</label>
                            <select class="form-select">
                                <option>بطاقة ائتمان</option>
                                <option>تحويل بنكي</option>
                                <option>نقدي</option>
                                <option>محفظة إلكترونية</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">تاريخ الدفع</label>
                            <input type="date" class="form-control" value="2024-10-28">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">رقم المرجع / الإيصال</label>
                            <input type="text" class="form-control" placeholder="REF-123456">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ملاحظات</label>
                            <textarea class="form-control" rows="3" placeholder="ملاحظات إضافية..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إلغاء</button>
                    <a href="/system/billing/payment-detail-admin.html" class="btn btn-success">
                        <i class="bi bi-check-circle me-2"></i>تسجيل الدفعة
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Reminder Modal -->
    <div class="modal fade" id="reminderModal" tabindex="-1" aria-labelledby="reminderModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reminderModalLabel"><i class="bi bi-envelope me-2"></i>إرسال تذكير دفع</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">نوع التذكير</label>
                        <select class="form-select">
                            <option>تذكير أول</option>
                            <option selected>تذكير ثاني</option>
                            <option>تذكير نهائي</option>
                            <option>إشعار تأخير</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">طريقة الإرسال</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="emailReminder" checked>
                            <label class="form-check-label" for="emailReminder">بريد إلكتروني</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="smsReminder" checked>
                            <label class="form-check-label" for="smsReminder">رسالة نصية</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="pushReminder">
                            <label class="form-check-label" for="pushReminder">إشعار تطبيق</label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">نص الرسالة</label>
                        <textarea class="form-control" rows="3">تذكير بدفع الفاتورة رقم INV-2024-001 بمبلغ 1,500.00 ر.س. يرجى سداد المبلغ قبل تاريخ 2024-11-15 لتجنب رسوم التأخير. شكراً لتعاونكم.</textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">إرسال التذكير</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

